<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>About the Kentuckiana Chronic Pain Association</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    
    <!--*************************************************************-->
	<!--********************* BOOTSTRAP *****************************-->
	<!--*************************************************************-->
	
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="/bootstrap-3.3.5-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">

	<!--
    
	<script src="bootstrap-3.3.5-dist/fonts/glyphicons-halflings-regular.woff"></script>
	<script src="bootstrap-3.3.5-dist/fonts/glyphicons-halflings-regular.ttf"></script>
	<script src="bootstrap-3.3.5-dist/fonts/glyphicons-halflings-regular.woff2"></script>
	
	-->

    <!--*************************************************************-->
	<!--********************* HANDLEBARS ****************************-->
	<!--*************************************************************-->
    
	<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.js"></script>
	
    <!--*************************************************************-->
	<!--*********************** FIREBASE ****************************-->
	<!--*************************************************************-->

    <script src="https://cdn.firebase.com/js/client/2.2.9/firebase.js"></script>
	
    <!--*************************************************************-->
	<!--********************* CUSTOM STYLE **************************-->
	<!--*************************************************************-->	
	
	<link href="css/testing.css" rel="stylesheet">

</head>

<body>

    <!--*************************************************************-->
	<!--*********************** NAVBAR ******************************-->
	<!--*************************************************************-->

    <nav class="navbar navbar-default navbar-fixed-top">

		<div class="container-fluid">

        <div class="navbar-header">

            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#test-navbar-collapse" aria-expanded="false">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">KCPS</a>			
		</div>

			<div class="collapse navbar-collapse" id="test-navbar-collapse">

                <ul class="nav navbar-nav navbar-right">

                    <li><a href='index.html'><span class="glyphicon glyphicon-home"> Home</span></a></li>
                    <li><a href='Calendar2.html'><span class="glyphicon glyphicon-calendar"></span> Calendar</a></li>
                    <li class='active'><a href='guestbook2.html'><span class="glyphicon glyphicon-book"></span> Guestbook</a></li>
                    <li><a href='contact.html'><span class="glyphicon glyphicon-envelope"></span> Contact</a></li>
                    <li><a href='directions.html'><span class="glyphicon glyphicon-map-marker"></span> Directions</a></li>

                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-link"></span> Resources</a>

                        <ul class="dropdown-menu">
                            <li><a href="http://www.theacpa.org" target="_blank">American Chronic Pain Assoc</a></li>
                            <li><a href="http://www.webmd.com/pain-management/guide/pain-management-support-resources" target="_blank">Pain Management Health Center</a></li>
							<li><a href="http://www.partnersagainstpain.com/" target="_blank">Partners Against Pain</a></li>
                        </ul>
                    </li>

                </ul>
				
            </div>

        </div>

	</nav>

	<!--*************************************************************-->
    <!--**********************  END OF NAVBAR  **********************-->
	<!--*************************************************************-->

    <div class="container">

        <div class="jumbotron">

            <h1>Kentuckiana Chronic Pain Support Group</h1>
            <p>A support group for those who suffer from chronic pain in the Greater Louisville, KY area.</p>

        </div>

    </div>
	
	<!--*************************************************************-->
    <!--*****************  GUESTBOOK INPUT FORM  ********************-->
	<!--*************************************************************-->

    <div class="container">

        <div class="col-lg-6">

            <legend>Guestbook</legend>
            <h2>Please sign the guestbook if you would like to leave a comment!</h2>
            <p>In the name field, please choose a name you wish to appear in the guestbook:</p>

            <form id="GuestBookForm" role="form">

                <div class="form-group">

                    <label for="name">Name:</label>
                    <input type="text" class="form-control" id="_name" name="name">

                    <label for="email">Email Address:</label>
                    <input type="email" class="form-control" id="_email" name="email">
                    <br>

                    <label for="city">City:</label>
                    <input type="text" class="form-control" id="_city" name="city">
                    <br>

                    <label for="state">State:</label>
                    <input type="text" class="form-control" id="_state" name="state">
                    <br>

                    <label for="zip">Zip:</label>
                    <input type="text" class="form-control" id="_zipcode" name="zipcode">
                    <br>

                    <p>Enter your comments below:</p>
                    <label for="comment">Comment:</label>
                    <textarea class="form-control" rows="5" id="_comment" name="comment"></textarea>

                    <button type="submit" id="gsubmitbtn" class="btn btn-default">Submit</button>

                </div>

            </form>

        </div>

		<!--*************************************************************-->
    	<!--********************  GUESTBOOK OUTPUT  *********************-->
		<!--*************************************************************-->
		
        <div class="col-lg-6">

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Guestbook</h2>
                </div>
                <div id="node-id" class="panel-body">

                </div>
            </div>

        </div>

    </div>

    <script id="entry-template" type="text/x-handlebars-template">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="row cardheader">
                    
					<span class="comment-name pull-left">{{name}}</span>
					<span class="comment-city-state pull-right">{{city}}, {{state}}</span>

                </div>
				
				<div class="row"> 
						{{comment}}
				</div>
            </div>
        </div>


    </script>
	
	<!--*************************************************************-->
    <!--*****************  FIREBASE & HANDLEBARS  *******************-->
	<!--*************************************************************-->

    <script>
        var source = $("#entry-template").html();

        var template = Handlebars.compile(source);

        var mydB = new Firebase("https://shining-heat-4384.firebaseio.com/");

        function funct2(evt) {

            alert('function');

            var name = $('#_name').val();
            var email = $('#_email').val();
            var city = $('#_city').val();
            var state = $('#_state').val();
            var zip = $('#_zipcode').val();
            var comment = $('#_comment').val();
            var date = Date();


            mydB.push({
                'name': name,
                'email': email,
                'city': city,
                'state': state,
                'zip': zip,
                'date': date,
                'comment': comment
            });

        }

        //-- Submit button code from form submit -------------------------------//

        var submit = document.getElementById('gsubmitbtn');

        submit.onclick = funct2;



        //-- For read of data firebase -----------------------------------------//



        mydB.once("value", function(allMessagesSnapshot) {
            allMessagesSnapshot.forEach(function(messageSnapshot) {

                var key = messageSnapshot.key();
                var name = messageSnapshot.child("name").val();
                var email = messageSnapshot.child("email").val();
                var city = messageSnapshot.child("city").val();
                var state = messageSnapshot.child("state").val();
                var zip = messageSnapshot.child("zip").val();
                var comment = messageSnapshot.child("comment").val();

                //-- Conditional statement to ignore fields where name is blank -------//

                if (name !== null) {
//                    console.log(messageSnapshot.val());
//                    var anyname = template(messageSnapshot.val());
//                    console.log(anyname);
                    $("#node-id").append(template(messageSnapshot.val()));

                }

            });
        });

        // Attach an asynchronous callback to read the data at our posts reference

        mydB.on("value", function(snapshot) {
            console.log(snapshot.val());
        }, function(errorObject) {
            console.log("The read failed: " + errorObject.code);
        });

        // End Asynchronous call //

        var myList = mydB.on("value", function(snapshot) {
            snapshot.val();
        });
    </script>
	
	<!--*************************************************************-->
    <!--*************************  SCRIPT REFS  *********************-->
	<!--*************************************************************-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>

</body>

	<!--*************************************************************-->
    <!--**********************  FOOTER ******************************-->
	<!--*************************************************************-->

    <footer>
        
		<a href="https://www.facebook.com/groups/KentuckianaChronicPain/" target="_blank">
		<img src="http://www.niftybuttons.com/scribble/facebook.png" border="0" margin="1px"></a>
        <a href="https://twitter.com/Patient2Person" target="_blank">
		<img src="http://www.niftybuttons.com/scribble/twitter.png" border="0" margin="1px"></a>

        <div class="container">
			
            <br>
            <p>If you are experiencing an emergency situation, please dial 911. To stay in touch with other members please follow the Facebook and Twitter icon links below. The Facebook group is a closed group and moderated. Closed group content cannot be seen by anyone other than those in the group. We are here to offer support, please do not hesitate to reach out.</p>
        </div>
    
	</footer>

	<!--*************************************************************-->
    <!--************************* END FOOTER  ***********************-->
	<!--*************************************************************-->

</html>